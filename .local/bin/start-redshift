#!/bin/bash

json=$(curl -s --connect-timeout 5 --retry 10 --retry-delay 5 "http://ip-api.com/json/?fields=lat,lon")
if [ -n "$json" ]; then
    lat=$(echo $json | jq ".lat")
    lon=$(echo $json | jq ".lon")
    location="$lat:$lon"
    echo $location > ~/.location
else
    location=$(cat ~/.location)
fi
pkill redshift-gtk
sleep 5
redshift-gtk -l "$location"
